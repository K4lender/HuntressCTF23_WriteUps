# PHP_Stager(Malware)
#### Zorluk: Easy

## Soru
![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP_Stager.png)

## Çözüm
Bize phonetic adlı bir dosya verilmiş. Bu dosyayı VS Code ile açıp baktığımda obfuscate edilmiş bir php dosyası olduğunu gördüm.

![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP1.PNG)

Dosyayı deobfuscate ederek okunabilir hale getirdim ve dosyanın içindeki payloadın nasıl bir fonksiyondan geçtiğini anladım. 

![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP2.PNG)

Deobfuscate ettiğimiz dosyayı çalıştırdığımızda bir php kodu elde ediyoruz. Bu php dosyası aslında gerçek hayattan alınmış zararlı bir script örneğidir. 

![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP3.PNG)

Kodda aşağılara doğru gittiğimizde ```$back_connect_p``` ve ```$bind_port_p``` değişkenlerinde base64 ile şifrelenmiş değerler olduğunu gördüm.

![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP4.PNG)

```$back_connect_p``` değişkenindeki değeri [Cyberchef](https://gchq.github.io/CyberChef/) sitesine atıp decode ettiğimde uuencode ile şifrelenmiş bir değer verildiğini gördüm.

![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP5.PNG)

[Drcode](https://www.dcode.fr/uu-encoding) sitesinde değeri girip decode ettiğimizde flagı elde ediyoruz.

![Soru](https://github.com/K4lender/HuntressCTF23_WriteUps/blob/main/Malware/PHP_Stager/PHP6.PNG)

```flag{9b5c4313d12958354be6284fcd63dd26}```
